<div class="container py-4">
  <div class="row">
    <div class="col-12">
      <div class="card shadow-sm">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h5 class="mb-0">Your Subscriptions</h5>
          <%= link_to "Billing Dashboard", billing_dashboard_path, class: "btn btn-sm btn-outline-secondary" %>
        </div>
        <div class="card-body">
          <% if @subscriptions.present? %>
            <div class="table-responsive">
              <table class="table align-middle">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Status</th>
                    <th>Current Period</th>
                    <th>Quantity</th>
                    <th>Plan</th>
                  </tr>
                </thead>
                <tbody>
                  <% @subscriptions.each do |sub| %>
                    <tr>
                      <td><%= sub.name %></td>
                      <td>
                        <span class="badge <%= sub.active? ? 'bg-success' : 'bg-secondary' %>"><%= sub.status %></span>
                      </td>
                      <td>
                        <% if sub.current_period_start && sub.current_period_end %>
                          <%= l(sub.current_period_start, format: :short) %> â€” <%= l(sub.current_period_end, format: :short) %>
                        <% else %>
                          <span class="text-muted">N/A</span>
                        <% end %>
                      </td>
                      <td><%= sub.quantity %></td>
                      <td><code><%= sub.processor_plan %></code></td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          <% else %>
            <p class="text-muted mb-0">You don't have any subscriptions yet.</p>
          <% end %>
        </div>
      </div>

      <% if current_user.payment_processor.processor.to_s == 'paddle' && ENV['PADDLE_CUSTOMER_PORTAL_URL'].present? %>
        <div class="alert alert-info mt-3 d-flex justify-content-between align-items-center">
          <div>
            Manage your Paddle subscription in the customer portal.
          </div>
          <a href="<%= ENV['PADDLE_CUSTOMER_PORTAL_URL'] %>" target="_blank" rel="noopener" class="btn btn-outline-primary">Open Paddle Portal</a>
        </div>
      <% end %>
    </div>
  </div>
</div>
